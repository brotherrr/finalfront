(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{6339:function(e,t,n){Promise.resolve().then(n.bind(n,8388))},3001:function(e,t,n){"use strict";n.d(t,{BJ:function(){return o},BZ:function(){return m},Fw:function(){return h},Ns:function(){return b},ZB:function(){return f},d8:function(){return r},jo:function(){return _},li:function(){return c},lp:function(){return l},m3:function(){return d},v_:function(){return p}});let r=e=>!(e instanceof Error),a=async e=>{try{let t=await fetch(e);if(200!==t.status)throw Error();return await t.json()}catch(e){return e}},s=e=>{let t=JSON.stringify(e),n=JSON.parse(t=t.replaceAll("_id","id"));return{...n,category:n.categories}},i=e=>e.map(e=>s(e)),u=(e,t)=>(e=i(e)).filter(e=>e.users.find(e=>e.id===t)),o=async(e,t)=>{let n=await a("".concat(e,"?categories.name=").concat(t));return r(n)?i(n):n},c=async(e,t)=>{let n=await a("".concat(e,"/").concat(t));return r(n)?s(n):n},l=async(e,t)=>{let n=await a(e);return r(n)?u(n,t):n},d=async(e,t,n)=>{try{let r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(200!==r.status&&"auth"===n)throw Error("Ошибка авторизации");if(200!==r.status&&"register"===n)throw Error("Ошибка регистрации");return await r.json()}catch(e){return e}},f=e=>{localStorage.setItem("jwt",e)},p=()=>localStorage.getItem("jwt"),h=()=>{localStorage.removeItem("jwt")},_=async(e,t)=>{try{let n=await fetch(e,{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(200!==n.status)throw Error("Ошибка получения данных");return await n.json()}catch(e){return e}},m=(e,t)=>e.users.find(e=>e.id===t),b=async(e,t,n)=>{try{let r=await fetch(e,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({users:n})});if(200!==r.status)throw Error("Ошибка голосования");return await r.json()}catch(e){return e}}},6932:function(e,t,n){"use strict";n.d(t,{H:function(){return a}});let r="https://brotherback.nomorepartiesco.ru/api",a={games:"".concat(r,"/games"),auth:"".concat(r,"/auth/login"),me:"".concat(r,"/me"),register:"".concat(r,"/registration")}},3270:function(e,t,n){"use strict";n.d(t,{p:function(){return a}});var r=n(7437);let a=()=>(0,r.jsx)("div",{style:{aspectRatio:"16/9",display:"grid",placeItems:"center"},className:"preloader",children:(0,r.jsxs)("svg",{style:{width:"10vw"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200",children:[(0,r.jsx)("circle",{fill:"#FFF500",stroke:"#FFF500",strokeWidth:"15",r:"15",cx:"35",cy:"100",children:(0,r.jsx)("animate",{attributeName:"cx",calcMode:"spline",dur:"2",values:"35;165;165;35;35",keySplines:"0 .1 .5 1;0 .1 .5 1;0 .1 .5 1;0 .1 .5 1",repeatCount:"indefinite",begin:"0"})}),(0,r.jsx)("circle",{fill:"#FFF500",stroke:"#FFF500",strokeWidth:"15",opacity:".8",r:"15",cx:"35",cy:"100",children:(0,r.jsx)("animate",{attributeName:"cx",calcMode:"spline",dur:"2",values:"35;165;165;35;35",keySplines:"0 .1 .5 1;0 .1 .5 1;0 .1 .5 1;0 .1 .5 1",repeatCount:"indefinite",begin:"0.05"})}),(0,r.jsx)("circle",{fill:"#FFF500",stroke:"#FFF500",strokeWidth:"15",opacity:".6",r:"15",cx:"35",cy:"100",children:(0,r.jsx)("animate",{attributeName:"cx",calcMode:"spline",dur:"2",values:"35;165;165;35;35",keySplines:"0 .1 .5 1;0 .1 .5 1;0 .1 .5 1;0 .1 .5 1",repeatCount:"indefinite",begin:".1"})}),(0,r.jsx)("circle",{fill:"#FFF500",stroke:"#FFF500",strokeWidth:"15",opacity:".4",r:"15",cx:"35",cy:"100",children:(0,r.jsx)("animate",{attributeName:"cx",calcMode:"spline",dur:"2",values:"35;165;165;35;35",keySplines:"0 .1 .5 1;0 .1 .5 1;0 .1 .5 1;0 .1 .5 1",repeatCount:"indefinite",begin:".15"})}),(0,r.jsx)("circle",{fill:"#FFF500",stroke:"#FFF500",strokeWidth:"15",opacity:".2",r:"15",cx:"35",cy:"100",children:(0,r.jsx)("animate",{attributeName:"cx",calcMode:"spline",dur:"2",values:"35;165;165;35;35",keySplines:"0 .1 .5 1;0 .1 .5 1;0 .1 .5 1;0 .1 .5 1",repeatCount:"indefinite",begin:".2"})})]})})},8388:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(7437),a=n(4848),s=n.n(a),i=n(2265),u=n(3001),o=n(6932),c=n(3270),l=n(7695);function d(e){let t=(0,l.o)(),[n,a]=(0,i.useState)(!1),[d,f]=(0,i.useState)(!0),[p,h]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async function(){let t=await (0,u.li)(o.H.games,e.params.id);(0,u.d8)(t)?h(t):h(null),f(!1)})()},[]),(0,i.useEffect)(()=>{t.user&&p?a((0,u.BZ)(p,t.user.id)):a(!1)},[t.user,p]);let _=async()=>{let e=t.token,n=p.users.length?p.users.map(e=>e.id):[];n.push(t.user.id);let r=await (0,u.Ns)("".concat(o.H.games,"/").concat(p.id),e,n);(0,u.d8)(r)&&(h(()=>({...p,users:[...p.users,t.user]})),a(!0))};return(0,r.jsx)("main",{className:"main",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("section",{className:s().game,children:(0,r.jsx)("iframe",{className:s().game__iframe,src:p.link})}),(0,r.jsxs)("section",{className:s().about,children:[(0,r.jsx)("h2",{className:s().about__title,children:p.title}),(0,r.jsxs)("div",{className:s().about__content,children:[(0,r.jsx)("p",{className:s().about__description,children:p.description}),(0,r.jsx)("div",{className:s().about__author,children:(0,r.jsxs)("p",{children:["Автор: ",(0,r.jsx)("span",{className:s().about__accent,children:p.developer})]})})]}),(0,r.jsxs)("div",{className:s().about__vote,children:[(0,r.jsxs)("p",{className:s()["about__vote-amount"],children:["За игру уже проголосовали: ",(0,r.jsx)("span",{className:s().about__accent,children:p.users.length})]}),(0,r.jsx)("button",{disabled:n,className:"button ".concat(s()["about__vote-button"]),onClick:t.isAuth?_:()=>{t.openPopup("auth")},children:n?"Голос учтён":"Голосовать"})]})]})]}):d?(0,r.jsx)(c.p,{}):(0,r.jsxs)("section",{className:s().not__found,children:[(0,r.jsx)("img",{src:"../images/page_not_found.png",alt:"Недовольный человечек"}),(0,r.jsx)("h3",{children:"Сударь, мне кажется вы ошиблись. Такой игры здесь нет. "})]})})}},7695:function(e,t,n){"use strict";let r;n.d(t,{o:function(){return _}});let a=e=>{let t;let n=new Set,r=(e,r)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),n.forEach(n=>n(t,e))}},a=()=>t,s={setState:r,getState:a,getInitialState:()=>i,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},i=t=e(r,a,s);return s},s=e=>e?a(e):a;var i=n(2265),u=n(5006);let{useDebugValue:o}=i,{useSyncExternalStoreWithSelector:c}=u,l=!1,d=e=>e,f=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?s(e):e,n=(e,n)=>(function(e,t=d,n){n&&!l&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),l=!0);let r=c(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return o(r),r})(t,e,n);return Object.assign(n,t),n};var p=n(3001),h=n(6932);let _=(r=e=>({isAuth:!1,popupIsOpened:!1,typeForm:null,user:null,token:null,login:(t,n)=>{e({isAuth:!0,user:t,token:n}),(0,p.ZB)(n)},logout:()=>{e({isAuth:!1,user:null,token:null}),(0,p.Fw)()},checkAuth:async()=>{let t=(0,p.v_)();if(t){let n=await (0,p.jo)(h.H.me,t);n instanceof Error?(e({isAuth:!1,user:null,token:null}),(0,p.Fw)()):(e({isAuth:!0,user:{...n,id:n._id},token:t}),(0,p.ZB)(t))}},openPopup:t=>{e({popupIsOpened:!0,typeForm:t})},closePopup:()=>{e({popupIsOpened:!1,typeForm:null})}}))?f(r):f},4492:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2265),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=r.useState,i=r.useEffect,u=r.useLayoutEffect,o=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!a(e,n)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=s({inst:{value:n,getSnapshot:t}}),a=r[0].inst,l=r[1];return u(function(){a.value=n,a.getSnapshot=t,c(a)&&l({inst:a})},[e,n,t]),i(function(){return c(a)&&l({inst:a}),e(function(){c(a)&&l({inst:a})})},[e]),o(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l},5107:function(e,t,n){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=n(2265),a=n(554),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=a.useSyncExternalStore,u=r.useRef,o=r.useEffect,c=r.useMemo,l=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var d=u(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;var p=i(e,(d=c(function(){function e(e){if(!o){if(o=!0,i=e,e=r(e),void 0!==a&&f.hasValue){var t=f.value;if(a(t,e))return u=t}return u=e}if(t=u,s(i,e))return t;var n=r(e);return void 0!==a&&a(t,n)?t:(i=e,u=n)}var i,u,o=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,a]))[0],d[1]);return o(function(){f.hasValue=!0,f.value=p},[p]),l(p),p}},554:function(e,t,n){"use strict";e.exports=n(4492)},5006:function(e,t,n){"use strict";e.exports=n(5107)},4848:function(e){e.exports={game:"Game_game__e7Yyk",not__found:"Game_not__found__MSrr9",game__iframe:"Game_game__iframe__CEKJi",about:"Game_about__KArKz",about__title:"Game_about__title__NUaKz",about__content:"Game_about__content__6h1Lj",about__accent:"Game_about__accent__ZgsOO",about__vote:"Game_about__vote__vHCxI","about__vote-button":"Game_about__vote-button__0lz0x"}}},function(e){e.O(0,[510,971,23,744],function(){return e(e.s=6339)}),_N_E=e.O()}]);